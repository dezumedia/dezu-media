"use client";

import { useEffect, useState, useRef } from "react";
import MobileMenu from "./mobile-menu";
import DesktopMenu from "./desktop-menu";
import ThemeToggle from "./theme-toggle";

const Navbar = () => {
  const [isHidden, setHidden] = useState(false);
  const lastScrollY = useRef(0);
  const threshold = 100;

  useEffect(() => {
    const handleScroll = () => {
      const currentScrollY = window.scrollY;
      if (Math.abs(currentScrollY - lastScrollY.current) > threshold) {
        if (currentScrollY > lastScrollY.current) {
          setHidden(true);
        } else {
          setHidden(false);
        }
        lastScrollY.current = currentScrollY;
      }
    };

    window.addEventListener("scroll", handleScroll);
    return () => {
      window.removeEventListener("scroll", handleScroll);
    };
  }, [threshold]);

  return (
    <nav
      className={`fixed px-3 py-3 bg-white dark:bg-zinc-950 shadow-md w-full duration-500 ease-in-out
      ${isHidden ? "-translate-y-full" : "translate-y-0"}`}
    >
      <div className="flex items-center justify-between mx-auto lg:max-w-5xl">
        <MobileMenu classname="lg:hidden" />
        <a href="/">
          <svg
            width="133"
            height="auto"
            viewBox="0 0 133 63"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
            className="max-w-20 text-zinc-950 dark:text-zinc-50 bg-cover"
          >
            <path
              d="M49.4726 56.775C49.776 56.775 50.031 56.8417 50.2376 56.975C50.4443 57.1083 50.5993 57.3117 50.7026 57.585C50.8093 57.855 50.8626 58.2 50.8626 58.62V61H50.2976V58.77C50.2976 58.2533 50.2276 57.8733 50.0876 57.63C49.9476 57.3867 49.6976 57.265 49.3376 57.265C49.1543 57.265 48.9726 57.3167 48.7926 57.42C48.616 57.52 48.4693 57.68 48.3526 57.9C48.236 58.12 48.1776 58.41 48.1776 58.77V61H47.6326V58.77C47.6326 58.2533 47.5426 57.8733 47.3626 57.63C47.1826 57.3867 46.946 57.265 46.6526 57.265C46.466 57.265 46.2843 57.3133 46.1076 57.41C45.9343 57.5067 45.791 57.6667 45.6776 57.89C45.5676 58.11 45.5126 58.4033 45.5126 58.77V61H44.9476V56.895H45.5126V57.545C45.546 57.4417 45.621 57.33 45.7376 57.21C45.8576 57.09 46.011 56.9883 46.1976 56.905C46.3843 56.8183 46.5976 56.775 46.8376 56.775C47.091 56.775 47.301 56.8317 47.4676 56.945C47.6343 57.0583 47.7643 57.1933 47.8576 57.35C47.951 57.5067 48.0093 57.65 48.0326 57.78C48.0826 57.6233 48.1726 57.4683 48.3026 57.315C48.4326 57.1617 48.5976 57.0333 48.7976 56.93C48.9976 56.8267 49.2226 56.775 49.4726 56.775ZM57.4618 59.015C57.4652 59.3017 57.5218 59.57 57.6318 59.82C57.7452 60.07 57.9152 60.2717 58.1418 60.425C58.3685 60.5783 58.6535 60.655 58.9968 60.655C59.2768 60.655 59.5102 60.61 59.6968 60.52C59.8868 60.4267 60.0368 60.32 60.1468 60.2C60.2602 60.0767 60.3402 59.9667 60.3868 59.87L60.7418 60.22C60.6185 60.41 60.4752 60.5733 60.3118 60.71C60.1518 60.8433 59.9618 60.945 59.7418 61.015C59.5252 61.085 59.2668 61.12 58.9668 61.12C58.5302 61.12 58.1568 61.0233 57.8468 60.83C57.5402 60.6333 57.3052 60.3667 57.1418 60.03C56.9818 59.6933 56.9018 59.315 56.9018 58.895C56.9018 58.495 56.9818 58.135 57.1418 57.815C57.3018 57.495 57.5318 57.2417 57.8318 57.055C58.1352 56.8683 58.5002 56.775 58.9268 56.775C59.3135 56.775 59.6485 56.86 59.9318 57.03C60.2185 57.2 60.4402 57.4367 60.5968 57.74C60.7568 58.04 60.8368 58.39 60.8368 58.79C60.8368 58.82 60.8352 58.8583 60.8318 58.905C60.8318 58.9517 60.8302 58.9883 60.8268 59.015H57.4618ZM60.2668 58.54C60.2635 58.36 60.2185 58.17 60.1318 57.97C60.0485 57.7667 59.9102 57.595 59.7168 57.455C59.5268 57.3117 59.2652 57.24 58.9318 57.24C58.5852 57.24 58.3085 57.31 58.1018 57.45C57.8985 57.5867 57.7502 57.755 57.6568 57.955C57.5635 58.155 57.5068 58.35 57.4868 58.54H60.2668ZM68.7098 61.12C68.3398 61.12 68.0048 61.035 67.7048 60.865C67.4048 60.6917 67.1665 60.4433 66.9898 60.12C66.8131 59.7933 66.7248 59.4033 66.7248 58.95C66.7248 58.4967 66.8131 58.1083 66.9898 57.785C67.1665 57.4583 67.4048 57.2083 67.7048 57.035C68.0048 56.8617 68.3398 56.775 68.7098 56.775C69.0265 56.775 69.3065 56.8333 69.5498 56.95C69.7931 57.0667 69.9865 57.2017 70.1298 57.355C70.2731 57.505 70.3515 57.635 70.3648 57.745V54.12H70.9448V61H70.3798V60.14C70.3565 60.2467 70.2715 60.3767 70.1248 60.53C69.9815 60.6833 69.7881 60.82 69.5448 60.94C69.3015 61.06 69.0231 61.12 68.7098 61.12ZM68.7798 60.62C69.0698 60.62 69.3348 60.5517 69.5748 60.415C69.8148 60.2783 70.0065 60.085 70.1498 59.835C70.2931 59.585 70.3648 59.29 70.3648 58.95C70.3648 58.61 70.2931 58.315 70.1498 58.065C70.0065 57.815 69.8148 57.6217 69.5748 57.485C69.3348 57.345 69.0698 57.275 68.7798 57.275C68.5198 57.275 68.2765 57.3433 68.0498 57.48C67.8265 57.6133 67.6448 57.805 67.5048 58.055C67.3648 58.305 67.2948 58.6033 67.2948 58.95C67.2948 59.2967 67.3648 59.595 67.5048 59.845C67.6448 60.095 67.8265 60.2867 68.0498 60.42C68.2765 60.5533 68.5198 60.62 68.7798 60.62ZM77.0679 61V56.895H77.6329V61H77.0679ZM77.3579 55.23C77.2379 55.23 77.1346 55.1883 77.0479 55.105C76.9646 55.0183 76.9229 54.915 76.9229 54.795C76.9229 54.6717 76.9663 54.5683 77.0529 54.485C77.1396 54.3983 77.2413 54.355 77.3579 54.355C77.4379 54.355 77.5113 54.375 77.5779 54.415C77.6479 54.455 77.7029 54.5083 77.7429 54.575C77.7863 54.6383 77.8079 54.7117 77.8079 54.795C77.8079 54.915 77.7629 55.0183 77.6729 55.105C77.5863 55.1883 77.4813 55.23 77.3579 55.23ZM87.4514 61V60.14C87.428 60.23 87.3497 60.3533 87.2164 60.51C87.0864 60.6667 86.9047 60.8083 86.6714 60.935C86.4414 61.0583 86.168 61.12 85.8514 61.12C85.4814 61.12 85.1397 61.035 84.8264 60.865C84.5164 60.6917 84.2664 60.4433 84.0764 60.12C83.8897 59.7933 83.7964 59.4033 83.7964 58.95C83.7964 58.4967 83.8897 58.1083 84.0764 57.785C84.2664 57.4583 84.5164 57.2083 84.8264 57.035C85.1397 56.8617 85.4814 56.775 85.8514 56.775C86.168 56.775 86.4414 56.835 86.6714 56.955C86.9014 57.0717 87.083 57.2067 87.2164 57.36C87.353 57.5133 87.4297 57.6417 87.4464 57.745V56.895H88.0064V61H87.4514ZM84.3614 58.95C84.3614 59.2967 84.4364 59.595 84.5864 59.845C84.7364 60.095 84.9297 60.2867 85.1664 60.42C85.4064 60.5533 85.658 60.62 85.9214 60.62C86.2114 60.62 86.4697 60.5517 86.6964 60.415C86.923 60.2783 87.1014 60.085 87.2314 59.835C87.3647 59.585 87.4314 59.29 87.4314 58.95C87.4314 58.61 87.3647 58.315 87.2314 58.065C87.1014 57.815 86.923 57.6217 86.6964 57.485C86.4697 57.345 86.2114 57.275 85.9214 57.275C85.658 57.275 85.4064 57.3433 85.1664 57.48C84.9297 57.6133 84.7364 57.805 84.5864 58.055C84.4364 58.305 84.3614 58.6033 84.3614 58.95Z"
              fill="currentColor"
            />
            <path
              d="M14.516 45.768C12.02 45.768 9.82267 45.1707 7.924 43.976C6.04667 42.76 4.57467 41.1067 3.508 39.016C2.46267 36.904 1.94 34.5253 1.94 31.88C1.94 29.2347 2.46267 26.8667 3.508 24.776C4.57467 22.664 6.04667 21 7.924 19.784C9.82267 18.568 12.02 17.96 14.516 17.96C16.2867 17.96 17.8547 18.248 19.22 18.824C20.6067 19.4 21.716 20.0827 22.548 20.872C23.38 21.6613 23.8707 22.3653 24.02 22.984V0.967999H32.18V45H24.116V40.424C23.7747 41.1707 23.1453 41.96 22.228 42.792C21.3107 43.624 20.1907 44.328 18.868 44.904C17.5453 45.48 16.0947 45.768 14.516 45.768ZM16.82 39.304C18.1853 39.304 19.412 38.9947 20.5 38.376C21.588 37.736 22.4413 36.8613 23.06 35.752C23.7 34.6213 24.02 33.3307 24.02 31.88C24.02 30.4293 23.7 29.1493 23.06 28.04C22.4413 26.9093 21.588 26.024 20.5 25.384C19.412 24.744 18.1853 24.424 16.82 24.424C15.5613 24.424 14.4093 24.744 13.364 25.384C12.3187 26.0027 11.476 26.8773 10.836 28.008C10.2173 29.1173 9.908 30.408 9.908 31.88C9.908 33.352 10.2173 34.6533 10.836 35.784C11.476 36.8933 12.3187 37.7573 13.364 38.376C14.4093 38.9947 15.5613 39.304 16.82 39.304ZM40.207 33.672C40.271 34.8667 40.591 35.9333 41.167 36.872C41.743 37.8107 42.575 38.5467 43.663 39.08C44.7723 39.6133 46.095 39.88 47.631 39.88C49.0177 39.88 50.2337 39.7093 51.279 39.368C52.3457 39.0267 53.2417 38.6107 53.967 38.12C54.7137 37.608 55.2683 37.1173 55.631 36.648L58.991 41.64C58.3937 42.3867 57.5937 43.08 56.591 43.72C55.6097 44.3387 54.351 44.8293 52.815 45.192C51.3003 45.576 49.4017 45.768 47.119 45.768C44.239 45.768 41.711 45.2027 39.535 44.072C37.359 42.9413 35.663 41.3093 34.447 39.176C33.231 37.0427 32.623 34.504 32.623 31.56C32.623 29 33.167 26.696 34.255 24.648C35.343 22.5787 36.9217 20.9467 38.991 19.752C41.0817 18.5573 43.5883 17.96 46.511 17.96C49.263 17.96 51.6417 18.4933 53.647 19.56C55.6737 20.6053 57.2417 22.1413 58.351 24.168C59.4603 26.1947 60.015 28.6693 60.015 31.592C60.015 31.7627 60.0043 32.1147 59.983 32.648C59.983 33.16 59.9617 33.5013 59.919 33.672H40.207ZM52.399 28.648C52.3777 27.9653 52.1643 27.2293 51.759 26.44C51.375 25.6507 50.767 24.9787 49.935 24.424C49.103 23.8693 47.9937 23.592 46.607 23.592C45.2203 23.592 44.079 23.8587 43.183 24.392C42.3083 24.9253 41.647 25.5867 41.199 26.376C40.751 27.144 40.495 27.9013 40.431 28.648H52.399ZM60.7995 18.728H85.6315L71.5195 39.208H84.7355V45H58.8155L72.9275 24.488H60.7995V18.728ZM93.534 31.304C93.534 33.6507 94.0033 35.528 94.942 36.936C95.8807 38.3227 97.3953 39.016 99.486 39.016C101.598 39.016 103.123 38.3227 104.062 36.936C105.001 35.528 105.47 33.6507 105.47 31.304V18.728H113.47V32.232C113.47 34.9413 112.926 37.32 111.838 39.368C110.75 41.3947 109.161 42.9733 107.07 44.104C105.001 45.2133 102.473 45.768 99.486 45.768C96.5207 45.768 93.9927 45.2133 91.902 44.104C89.8327 42.9733 88.254 41.3947 87.166 39.368C86.078 37.32 85.534 34.9413 85.534 32.232V18.728H93.534V31.304ZM122.505 45.768C121.076 45.768 119.85 45.256 118.826 44.232C117.801 43.208 117.289 41.9813 117.289 40.552C117.289 39.08 117.801 37.832 118.826 36.808C119.85 35.784 121.076 35.272 122.505 35.272C123.977 35.272 125.215 35.784 126.218 36.808C127.242 37.832 127.753 39.08 127.753 40.552C127.753 41.9813 127.242 43.208 126.218 44.232C125.215 45.256 123.977 45.768 122.505 45.768Z"
              fill="currentColor"
            />
          </svg>
        </a>
        <DesktopMenu classname="items-center hidden lg:flex" />
        <div className="flex items-center gap-2">
          <a href="/search" className="text-zinc-950 dark:text-zinc-50">
            <svg
              width="30"
              height="30"
              viewBox="0 0 15 15"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M10 6.5C10 8.433 8.433 10 6.5 10C4.567 10 3 8.433 3 6.5C3 4.567 4.567 3 6.5 3C8.433 3 10 4.567 10 6.5ZM9.30884 10.0159C8.53901 10.6318 7.56251 11 6.5 11C4.01472 11 2 8.98528 2 6.5C2 4.01472 4.01472 2 6.5 2C8.98528 2 11 4.01472 11 6.5C11 7.56251 10.6318 8.53901 10.0159 9.30884L12.8536 12.1464C13.0488 12.3417 13.0488 12.6583 12.8536 12.8536C12.6583 13.0488 12.3417 13.0488 12.1464 12.8536L9.30884 10.0159Z"
                fill="currentColor"
                fillRule="evenodd"
                clipRule="evenodd"
              ></path>
            </svg>
          </a>
          <ThemeToggle className="hidden lg:flex" />
        </div>
      </div>
    </nav>
  );
};

export default Navbar;
